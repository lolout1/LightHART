[2025-03-14 22:08:24] Starting training script at Fri Mar 14 22:08:24 CDT 2025
[2025-03-14 22:08:24] CUDA_VISIBLE_DEVICES=0
[2025-03-14 22:08:24] Python version: Python 3.9.16
[2025-03-14 22:08:24] Running diagnostics...
[2025-03-14 22:08:24] Checking dependencies...
NumPy: 1.26.3
Pandas: 2.0.1
SciPy: 1.10.1
PyTorch: 2.6.0+cu118
[2025-03-14 22:08:27] Checking module files...
[2025-03-14 22:08:27]   utils/imu_fusion.py: Found
[2025-03-14 22:08:27]   utils/dataset.py: Found
[2025-03-14 22:08:27]   utils/loader.py: Found
[2025-03-14 22:08:27] Testing IMU fusion module...
Successfully imported from utils.imu_fusion
align_sensor_data: utils.imu_fusion
process_imu_data: utils.imu_fusion
extract_features_from_window: utils.imu_fusion
[2025-03-14 22:08:29] Checking CUDA availability...
  File "<string>", line 1
    import torch; print(f"CUDA available: {torch.cuda.is_available()}"); print(f"CUDA devices: {torch.cuda.device_count()}"); print(f"CUDA device: {torch.cuda.get_device_name(0) if torch.cuda.is_available() else \"None\"}")
                                                                                                                                                                                                                              ^
SyntaxError: f-string expression part cannot include a backslash
[2025-03-14 22:08:29] Creating config file: ./config/smartfallmm/fusion_madgwick.yaml
[2025-03-14 22:08:29]   Fusion type: concat
[2025-03-14 22:08:29]   Interpolation method: madgwick
[2025-03-14 22:08:29]   Acc threshold: 3.0
[2025-03-14 22:08:29]   Gyro threshold: 1.0
[2025-03-14 22:08:29] Preparing to train Madgwick fusion model...
[2025-03-14 22:08:29] ===========================================================
[2025-03-14 22:08:29] Training model: fusion_madgwick
[2025-03-14 22:08:29] Config: ./config/smartfallmm/fusion_madgwick.yaml
[2025-03-14 22:08:29] Work dir: results_hybrid/fusion_madgwick
[2025-03-14 22:08:29] ===========================================================
[2025-03-14 22:08:29] Config file contents:
[2025-03-14 22:08:29]   model: Models.fusion_transformer.FusionTransModel
[2025-03-14 22:08:29]   dataset: smartfallmm
[2025-03-14 22:08:29]   
[2025-03-14 22:08:29]   # Fall detection subjects
[2025-03-14 22:08:29]   subjects: [29,30,31,33,45,46,34,37,39,38,43,35,36,44,34,32]
[2025-03-14 22:08:29]   
[2025-03-14 22:08:29]   model_args:
[2025-03-14 22:08:29]   num_layers: 2
[2025-03-14 22:08:29]   embed_dim: 24
[2025-03-14 22:08:29]   acc_coords: 3
[2025-03-14 22:08:29]   quat_coords: 4
[2025-03-14 22:08:29]   num_classes: 2
[2025-03-14 22:08:29]   acc_frames: 64
[2025-03-14 22:08:29]   mocap_frames: 64
[2025-03-14 22:08:29]   num_heads: 4
[2025-03-14 22:08:29]   fusion_type: 'concat'
[2025-03-14 22:08:29]   dropout: 0.3
[2025-03-14 22:08:29]   use_batch_norm: true
[2025-03-14 22:08:29]   
[2025-03-14 22:08:29]   dataset_args:
[2025-03-14 22:08:29]   mode: 'sliding_window'
[2025-03-14 22:08:29]   max_length: 64
[2025-03-14 22:08:29]   task: 'fd'
[2025-03-14 22:08:29]   modalities: ['accelerometer', 'gyroscope']
[2025-03-14 22:08:29]   age_group: ['young']
[2025-03-14 22:08:29]   sensors: ['watch']
[2025-03-14 22:08:29]   fusion_options:
[2025-03-14 22:08:29]   enabled: true
[2025-03-14 22:08:29]   filter_type: 'madgwick'
[2025-03-14 22:08:29]   acc_threshold: 3.0
[2025-03-14 22:08:29]   gyro_threshold: 1.0
[2025-03-14 22:08:29]   visualize: true
[2025-03-14 22:08:29]   
[2025-03-14 22:08:29]   batch_size: 16
[2025-03-14 22:08:29]   test_batch_size: 16
[2025-03-14 22:08:29]   val_batch_size: 16
[2025-03-14 22:08:29]   num_epoch: 40
[2025-03-14 22:08:29]   
[2025-03-14 22:08:29]   # dataloader
[2025-03-14 22:08:29]   feeder: Feeder.Make_Dataset.UTD_mm
[2025-03-14 22:08:29]   train_feeder_args:
[2025-03-14 22:08:29]   batch_size: 16
[2025-03-14 22:08:29]   
[2025-03-14 22:08:29]   val_feeder_args:
[2025-03-14 22:08:29]   batch_size: 16
[2025-03-14 22:08:29]   
[2025-03-14 22:08:29]   test_feeder_args:
[2025-03-14 22:08:29]   batch_size: 16
[2025-03-14 22:08:29]   
[2025-03-14 22:08:29]   seed: 2
[2025-03-14 22:08:29]   optimizer: adam
[2025-03-14 22:08:29]   base_lr: 0.0005
[2025-03-14 22:08:29]   weight_decay: 0.001
[2025-03-14 22:08:29] Starting training process...
2025-03-14 22:08:33,219 - loader - INFO - Initializing DatasetBuilder with mode=sliding_window, task=fd
2025-03-14 22:08:33,239 - loader - INFO - Fusion options: enabled=True, filter_type=madgwick
2025-03-14 22:08:33,271 - loader - INFO - Making dataset for subjects=[31, 33, 45, 46, 34, 37, 39, 38, 43, 35, 36, 44, 34, 32], fuse=True, filter_type=madgwick
2025-03-14 22:08:33,612 - loader - INFO - Aligning skeleton and inertial data
2025-03-14 22:08:33,653 - loader - WARNING - Missing skeleton data for alignment
2025-03-14 22:08:33,685 - loader - INFO - Aligning sensors using hybrid interpolation at 30Hz
2025-03-14 22:08:34,036 - loader - INFO - Hybrid interpolation complete: 351 aligned samples in 0.35s
2025-03-14 22:08:40,818 - loader - INFO - Inertial sensors aligned with 351 samples
2025-03-14 22:08:40,843 - loader - INFO - Processing data for label 0 with mode=sliding_window
2025-03-14 22:08:41,009 - loader - INFO - Creating selective windows: peaks=11, fusion=True, filter_type=madgwick
2025-03-14 22:08:41,046 - imu_fusion - INFO - Processing IMU data: acc=(64, 3), gyro=(64, 3), filter=madgwick
2025-03-14 22:08:45,521 - imu_fusion - INFO - IMU processing complete in 4.48s
2025-03-14 22:08:45,569 - imu_fusion - INFO - Processing IMU data: acc=(64, 3), gyro=(64, 3), filter=madgwick
2025-03-14 22:08:49,689 - imu_fusion - INFO - IMU processing complete in 4.12s
2025-03-14 22:08:49,752 - imu_fusion - INFO - Processing IMU data: acc=(64, 3), gyro=(64, 3), filter=madgwick
2025-03-14 22:08:52,413 - imu_fusion - INFO - IMU processing complete in 2.66s
2025-03-14 22:08:52,435 - imu_fusion - INFO - Processing IMU data: acc=(64, 3), gyro=(64, 3), filter=madgwick
2025-03-14 22:08:55,582 - imu_fusion - INFO - IMU processing complete in 3.15s
2025-03-14 22:08:55,640 - imu_fusion - INFO - Processing IMU data: acc=(64, 3), gyro=(64, 3), filter=madgwick
2025-03-14 22:08:59,097 - imu_fusion - INFO - IMU processing complete in 3.46s
2025-03-14 22:08:59,166 - imu_fusion - INFO - Processing IMU data: acc=(64, 3), gyro=(64, 3), filter=madgwick
2025-03-14 22:09:03,838 - imu_fusion - INFO - IMU processing complete in 4.67s
2025-03-14 22:09:03,879 - imu_fusion - INFO - Processing IMU data: acc=(64, 3), gyro=(64, 3), filter=madgwick
2025-03-14 22:09:08,093 - imu_fusion - INFO - IMU processing complete in 4.21s
2025-03-14 22:09:08,161 - imu_fusion - INFO - Processing IMU data: acc=(64, 3), gyro=(64, 3), filter=madgwick
2025-03-14 22:09:12,532 - imu_fusion - INFO - IMU processing complete in 4.37s
2025-03-14 22:09:12,615 - imu_fusion - INFO - Processing IMU data: acc=(64, 3), gyro=(64, 3), filter=madgwick
2025-03-14 22:09:17,374 - imu_fusion - INFO - IMU processing complete in 4.76s
2025-03-14 22:09:17,415 - imu_fusion - INFO - Processing IMU data: acc=(64, 3), gyro=(64, 3), filter=madgwick
2025-03-14 22:09:21,753 - imu_fusion - INFO - IMU processing complete in 4.34s
2025-03-14 22:09:21,800 - imu_fusion - INFO - Processing IMU data: acc=(64, 3), gyro=(64, 3), filter=madgwick
2025-03-14 22:09:26,018 - imu_fusion - INFO - IMU processing complete in 4.22s
2025-03-14 22:09:26,255 - loader - INFO - Created 11 windows in 45.25s
2025-03-14 22:09:26,875 - loader - INFO - Aligning skeleton and inertial data
2025-03-14 22:09:26,900 - loader - WARNING - Missing skeleton data for alignment
2025-03-14 22:09:26,938 - loader - INFO - Aligning sensors using hybrid interpolation at 30Hz
2025-03-14 22:09:27,275 - loader - INFO - Hybrid interpolation complete: 451 aligned samples in 0.34s
2025-03-14 22:09:34,541 - loader - INFO - Inertial sensors aligned with 451 samples
2025-03-14 22:09:34,542 - loader - INFO - Processing data for label 1 with mode=sliding_window
2025-03-14 22:09:34,734 - loader - INFO - Creating selective windows: peaks=9, fusion=True, filter_type=madgwick
2025-03-14 22:09:34,756 - imu_fusion - INFO - Processing IMU data: acc=(64, 3), gyro=(64, 3), filter=madgwick
2025-03-14 22:09:38,096 - imu_fusion - INFO - IMU processing complete in 3.34s
2025-03-14 22:09:38,139 - imu_fusion - INFO - Processing IMU data: acc=(64, 3), gyro=(64, 3), filter=madgwick
2025-03-14 22:09:41,110 - imu_fusion - INFO - IMU processing complete in 2.97s
2025-03-14 22:09:41,148 - imu_fusion - INFO - Processing IMU data: acc=(64, 3), gyro=(64, 3), filter=madgwick
2025-03-14 22:09:44,657 - imu_fusion - INFO - IMU processing complete in 3.51s
2025-03-14 22:09:44,707 - imu_fusion - INFO - Processing IMU data: acc=(64, 3), gyro=(64, 3), filter=madgwick
2025-03-14 22:09:48,225 - imu_fusion - INFO - IMU processing complete in 3.52s
2025-03-14 22:09:48,267 - imu_fusion - INFO - Processing IMU data: acc=(64, 3), gyro=(64, 3), filter=madgwick
2025-03-14 22:09:52,118 - imu_fusion - INFO - IMU processing complete in 3.85s
2025-03-14 22:09:52,165 - imu_fusion - INFO - Processing IMU data: acc=(64, 3), gyro=(64, 3), filter=madgwick
2025-03-14 22:09:56,773 - imu_fusion - INFO - IMU processing complete in 4.61s
2025-03-14 22:09:56,845 - imu_fusion - INFO - Processing IMU data: acc=(64, 3), gyro=(64, 3), filter=madgwick
2025-03-14 22:10:00,913 - imu_fusion - INFO - IMU processing complete in 4.07s
2025-03-14 22:10:01,173 - loader - INFO - Created 7 windows in 26.44s
2025-03-14 22:10:01,880 - loader - INFO - Aligning skeleton and inertial data
2025-03-14 22:10:01,908 - loader - WARNING - Missing skeleton data for alignment
2025-03-14 22:10:01,942 - loader - INFO - Aligning sensors using hybrid interpolation at 30Hz
2025-03-14 22:10:02,232 - loader - INFO - Hybrid interpolation complete: 95 aligned samples in 0.29s
2025-03-14 22:10:08,995 - loader - INFO - Inertial sensors aligned with 95 samples
2025-03-14 22:10:09,012 - loader - INFO - Processing data for label 0 with mode=sliding_window
2025-03-14 22:10:09,093 - loader - INFO - Creating selective windows: peaks=3, fusion=True, filter_type=madgwick
2025-03-14 22:10:09,106 - imu_fusion - INFO - Processing IMU data: acc=(64, 3), gyro=(64, 3), filter=madgwick
2025-03-14 22:10:09,306 - imu_fusion - INFO - IMU processing complete in 0.20s
2025-03-14 22:10:09,306 - imu_fusion - INFO - Processing IMU data: acc=(64, 3), gyro=(64, 3), filter=madgwick
2025-03-14 22:10:09,327 - imu_fusion - INFO - IMU processing complete in 0.02s
2025-03-14 22:10:09,328 - loader - INFO - Created 2 windows in 0.23s
2025-03-14 22:10:09,337 - loader - INFO - Aligning skeleton and inertial data
2025-03-14 22:10:09,337 - loader - WARNING - Missing skeleton data for alignment
2025-03-14 22:10:09,339 - loader - INFO - Aligning sensors using hybrid interpolation at 30Hz
2025-03-14 22:10:09,344 - loader - INFO - Hybrid interpolation complete: 221 aligned samples in 0.01s
2025-03-14 22:10:09,988 - loader - INFO - Inertial sensors aligned with 221 samples
2025-03-14 22:10:09,988 - loader - INFO - Processing data for label 1 with mode=sliding_window
2025-03-14 22:10:09,988 - loader - INFO - Creating selective windows: peaks=8, fusion=True, filter_type=madgwick
2025-03-14 22:10:09,988 - imu_fusion - INFO - Processing IMU data: acc=(64, 3), gyro=(64, 3), filter=madgwick
2025-03-14 22:10:10,000 - imu_fusion - INFO - IMU processing complete in 0.01s
2025-03-14 22:10:10,000 - imu_fusion - INFO - Processing IMU data: acc=(64, 3), gyro=(64, 3), filter=madgwick
2025-03-14 22:10:10,014 - imu_fusion - INFO - IMU processing complete in 0.01s
2025-03-14 22:10:10,014 - imu_fusion - INFO - Processing IMU data: acc=(64, 3), gyro=(64, 3), filter=madgwick
2025-03-14 22:10:10,028 - imu_fusion - INFO - IMU processing complete in 0.01s
2025-03-14 22:10:10,030 - imu_fusion - INFO - Processing IMU data: acc=(64, 3), gyro=(64, 3), filter=madgwick
2025-03-14 22:10:10,056 - imu_fusion - INFO - IMU processing complete in 0.03s
2025-03-14 22:10:10,056 - imu_fusion - INFO - Processing IMU data: acc=(64, 3), gyro=(64, 3), filter=madgwick
2025-03-14 22:10:10,072 - imu_fusion - INFO - IMU processing complete in 0.02s
2025-03-14 22:10:10,072 - imu_fusion - INFO - Processing IMU data: acc=(64, 3), gyro=(64, 3), filter=madgwick
2025-03-14 22:10:10,089 - imu_fusion - INFO - IMU processing complete in 0.02s
2025-03-14 22:10:10,089 - imu_fusion - INFO - Processing IMU data: acc=(64, 3), gyro=(64, 3), filter=madgwick
2025-03-14 22:10:10,106 - imu_fusion - INFO - IMU processing complete in 0.02s
2025-03-14 22:10:10,106 - loader - INFO - Created 7 windows in 0.12s
2025-03-14 22:10:10,113 - loader - INFO - Aligning skeleton and inertial data
2025-03-14 22:10:10,113 - loader - WARNING - Missing skeleton data for alignment
2025-03-14 22:10:10,115 - loader - INFO - Aligning sensors using hybrid interpolation at 30Hz
2025-03-14 22:10:10,131 - loader - INFO - Hybrid interpolation complete: 1511 aligned samples in 0.02s
2025-03-14 22:10:14,599 - loader - INFO - Inertial sensors aligned with 1511 samples
2025-03-14 22:10:14,615 - loader - INFO - Processing data for label 1 with mode=sliding_window
2025-03-14 22:10:14,731 - loader - INFO - Creating selective windows: peaks=0, fusion=True, filter_type=madgwick
2025-03-14 22:10:14,731 - loader - INFO - Created 0 windows in 0.00s
2025-03-14 22:10:14,759 - loader - WARNING - Insufficient data after processing, skipping trial
2025-03-14 22:10:14,964 - loader - INFO - Aligning skeleton and inertial data
2025-03-14 22:10:14,981 - loader - WARNING - Missing skeleton data for alignment
2025-03-14 22:10:14,997 - loader - INFO - Aligning sensors using hybrid interpolation at 30Hz
2025-03-14 22:10:15,166 - loader - INFO - Hybrid interpolation complete: 2379 aligned samples in 0.17s
2025-03-14 22:10:19,313 - loader - INFO - Inertial sensors aligned with 2379 samples
2025-03-14 22:10:19,336 - loader - INFO - Processing data for label 0 with mode=sliding_window
2025-03-14 22:10:19,477 - loader - INFO - Creating selective windows: peaks=54, fusion=True, filter_type=madgwick
2025-03-14 22:10:19,508 - imu_fusion - INFO - Processing IMU data: acc=(64, 3), gyro=(64, 3), filter=madgwick
2025-03-14 22:10:23,337 - imu_fusion - INFO - IMU processing complete in 3.83s
2025-03-14 22:10:23,392 - imu_fusion - INFO - Processing IMU data: acc=(64, 3), gyro=(64, 3), filter=madgwick
2025-03-14 22:10:27,595 - imu_fusion - INFO - IMU processing complete in 4.20s
2025-03-14 22:10:27,661 - imu_fusion - INFO - Processing IMU data: acc=(64, 3), gyro=(64, 3), filter=madgwick
2025-03-14 22:10:31,583 - imu_fusion - INFO - IMU processing complete in 3.92s
2025-03-14 22:10:31,658 - imu_fusion - INFO - Processing IMU data: acc=(64, 3), gyro=(64, 3), filter=madgwick
2025-03-14 22:10:35,780 - imu_fusion - INFO - IMU processing complete in 4.12s
2025-03-14 22:10:35,844 - imu_fusion - INFO - Processing IMU data: acc=(64, 3), gyro=(64, 3), filter=madgwick
2025-03-14 22:10:39,651 - imu_fusion - INFO - IMU processing complete in 3.81s
2025-03-14 22:10:39,697 - imu_fusion - INFO - Processing IMU data: acc=(64, 3), gyro=(64, 3), filter=madgwick
2025-03-14 22:10:42,816 - imu_fusion - INFO - IMU processing complete in 3.12s
2025-03-14 22:10:42,816 - imu_fusion - INFO - Processing IMU data: acc=(64, 3), gyro=(64, 3), filter=madgwick
slurmstepd: error: *** JOB 507868 ON gpu1-001 CANCELLED AT 2025-03-14T22:10:44 ***
